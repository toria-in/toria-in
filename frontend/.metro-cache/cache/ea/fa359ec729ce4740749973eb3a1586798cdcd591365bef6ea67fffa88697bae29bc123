{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":3,"column":29,"index":44},"end":{"line":3,"column":84,"index":99}}],"key":"kslwqCIsh6ew+I1KeA1rlVRjsAk=","exportNames":["*"],"imports":1}},{"name":"@babel/runtime/helpers/objectSpread2","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":6,"column":44,"index":206},"end":{"line":6,"column":91,"index":253}}],"key":"F+ExrfS9dcoZxXJOBwTmx09hji8=","exportNames":["*"],"imports":1}},{"name":"fbjs/lib/invariant","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":7,"column":40,"index":296},"end":{"line":7,"column":69,"index":325}}],"key":"ePiUN85REKH0vTLGPPDgdWgjFww=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _interopRequireDefault = require(_dependencyMap[0], \"@babel/runtime/helpers/interopRequireDefault\").default;\n  exports.__esModule = true;\n  exports.default = void 0;\n  var _objectSpread2 = _interopRequireDefault(require(_dependencyMap[1], \"@babel/runtime/helpers/objectSpread2\"));\n  var _invariant = _interopRequireDefault(require(_dependencyMap[2], \"fbjs/lib/invariant\"));\n  /**\n   * Copyright (c) Nicolas Gallagher.\n   * Copyright (c) Meta Platforms, Inc. and affiliates.\n   *\n   * This source code is licensed under the MIT license found in the\n   * LICENSE file in the root directory of this source tree.\n   *\n   * \n   */\n\n  class TaskQueue {\n    constructor(_ref) {\n      var onMoreTasks = _ref.onMoreTasks;\n      this._onMoreTasks = onMoreTasks;\n      this._queueStack = [{\n        tasks: [],\n        popable: true\n      }];\n    }\n    enqueue(task) {\n      this._getCurrentQueue().push(task);\n    }\n    enqueueTasks(tasks) {\n      tasks.forEach(task => this.enqueue(task));\n    }\n    cancelTasks(tasksToCancel) {\n      this._queueStack = this._queueStack.map(queue => (0, _objectSpread2.default)((0, _objectSpread2.default)({}, queue), {}, {\n        tasks: queue.tasks.filter(task => tasksToCancel.indexOf(task) === -1)\n      })).filter((queue, idx) => queue.tasks.length > 0 || idx === 0);\n    }\n    hasTasksToProcess() {\n      return this._getCurrentQueue().length > 0;\n    }\n\n    /**\n     * Executes the next task in the queue.\n     */\n    processNext() {\n      var queue = this._getCurrentQueue();\n      if (queue.length) {\n        var task = queue.shift();\n        try {\n          if (typeof task === 'object' && task.gen) {\n            this._genPromise(task);\n          } else if (typeof task === 'object' && task.run) {\n            task.run();\n          } else {\n            (0, _invariant.default)(typeof task === 'function', 'Expected Function, SimpleTask, or PromiseTask, but got:\\n' + JSON.stringify(task, null, 2));\n            task();\n          }\n        } catch (e) {\n          e.message = 'TaskQueue: Error with task ' + (task.name || '') + ': ' + e.message;\n          throw e;\n        }\n      }\n    }\n    _getCurrentQueue() {\n      var stackIdx = this._queueStack.length - 1;\n      var queue = this._queueStack[stackIdx];\n      if (queue.popable && queue.tasks.length === 0 && stackIdx > 0) {\n        this._queueStack.pop();\n        return this._getCurrentQueue();\n      } else {\n        return queue.tasks;\n      }\n    }\n    _genPromise(task) {\n      var length = this._queueStack.push({\n        tasks: [],\n        popable: false\n      });\n      var stackIdx = length - 1;\n      var stackItem = this._queueStack[stackIdx];\n      task.gen().then(() => {\n        stackItem.popable = true;\n        this.hasTasksToProcess() && this._onMoreTasks();\n      }).catch(ex => {\n        setTimeout(() => {\n          ex.message = \"TaskQueue: Error resolving Promise in task \" + task.name + \": \" + ex.message;\n          throw ex;\n        }, 0);\n      });\n    }\n  }\n  var _default = exports.default = TaskQueue;\n  module.exports = exports.default;\n});","lineCount":95,"map":[[2,2,1,0],[2,14,1,12],[4,2,3,0],[4,6,3,4,"_interopRequireDefault"],[4,28,3,26],[4,31,3,29,"require"],[4,38,3,36],[4,39,3,36,"_dependencyMap"],[4,53,3,36],[4,104,3,83],[4,105,3,84],[4,106,3,85,"default"],[4,113,3,92],[5,2,4,0,"exports"],[5,9,4,7],[5,10,4,8,"__esModule"],[5,20,4,18],[5,23,4,21],[5,27,4,25],[6,2,5,0,"exports"],[6,9,5,7],[6,10,5,8,"default"],[6,17,5,15],[6,20,5,18],[6,25,5,23],[6,26,5,24],[7,2,6,0],[7,6,6,4,"_objectSpread2"],[7,20,6,18],[7,23,6,21,"_interopRequireDefault"],[7,45,6,43],[7,46,6,44,"require"],[7,53,6,51],[7,54,6,51,"_dependencyMap"],[7,68,6,51],[7,111,6,90],[7,112,6,91],[7,113,6,92],[8,2,7,0],[8,6,7,4,"_invariant"],[8,16,7,14],[8,19,7,17,"_interopRequireDefault"],[8,41,7,39],[8,42,7,40,"require"],[8,49,7,47],[8,50,7,47,"_dependencyMap"],[8,64,7,47],[8,89,7,68],[8,90,7,69],[8,91,7,70],[9,2,8,0],[10,0,9,0],[11,0,10,0],[12,0,11,0],[13,0,12,0],[14,0,13,0],[15,0,14,0],[16,0,15,0],[17,0,16,0],[19,2,18,0],[19,8,18,6,"TaskQueue"],[19,17,18,15],[19,18,18,16],[20,4,19,2,"constructor"],[20,15,19,13,"constructor"],[20,16,19,14,"_ref"],[20,20,19,18],[20,22,19,20],[21,6,20,4],[21,10,20,8,"onMoreTasks"],[21,21,20,19],[21,24,20,22,"_ref"],[21,28,20,26],[21,29,20,27,"onMoreTasks"],[21,40,20,38],[22,6,21,4],[22,10,21,8],[22,11,21,9,"_onMoreTasks"],[22,23,21,21],[22,26,21,24,"onMoreTasks"],[22,37,21,35],[23,6,22,4],[23,10,22,8],[23,11,22,9,"_queueStack"],[23,22,22,20],[23,25,22,23],[23,26,22,24],[24,8,23,6,"tasks"],[24,13,23,11],[24,15,23,13],[24,17,23,15],[25,8,24,6,"popable"],[25,15,24,13],[25,17,24,15],[26,6,25,4],[26,7,25,5],[26,8,25,6],[27,4,26,2],[28,4,27,2,"enqueue"],[28,11,27,9,"enqueue"],[28,12,27,10,"task"],[28,16,27,14],[28,18,27,16],[29,6,28,4],[29,10,28,8],[29,11,28,9,"_getCurrentQueue"],[29,27,28,25],[29,28,28,26],[29,29,28,27],[29,30,28,28,"push"],[29,34,28,32],[29,35,28,33,"task"],[29,39,28,37],[29,40,28,38],[30,4,29,2],[31,4,30,2,"enqueueTasks"],[31,16,30,14,"enqueueTasks"],[31,17,30,15,"tasks"],[31,22,30,20],[31,24,30,22],[32,6,31,4,"tasks"],[32,11,31,9],[32,12,31,10,"forEach"],[32,19,31,17],[32,20,31,18,"task"],[32,24,31,22],[32,28,31,26],[32,32,31,30],[32,33,31,31,"enqueue"],[32,40,31,38],[32,41,31,39,"task"],[32,45,31,43],[32,46,31,44],[32,47,31,45],[33,4,32,2],[34,4,33,2,"cancelTasks"],[34,15,33,13,"cancelTasks"],[34,16,33,14,"tasksToCancel"],[34,29,33,27],[34,31,33,29],[35,6,34,4],[35,10,34,8],[35,11,34,9,"_queueStack"],[35,22,34,20],[35,25,34,23],[35,29,34,27],[35,30,34,28,"_queueStack"],[35,41,34,39],[35,42,34,40,"map"],[35,45,34,43],[35,46,34,44,"queue"],[35,51,34,49],[35,55,34,53],[35,56,34,54],[35,57,34,55],[35,59,34,57,"_objectSpread2"],[35,73,34,71],[35,74,34,72,"default"],[35,81,34,79],[35,83,34,81],[35,84,34,82],[35,85,34,83],[35,87,34,85,"_objectSpread2"],[35,101,34,99],[35,102,34,100,"default"],[35,109,34,107],[35,111,34,109],[35,112,34,110],[35,113,34,111],[35,115,34,113,"queue"],[35,120,34,118],[35,121,34,119],[35,123,34,121],[35,124,34,122],[35,125,34,123],[35,127,34,125],[36,8,35,6,"tasks"],[36,13,35,11],[36,15,35,13,"queue"],[36,20,35,18],[36,21,35,19,"tasks"],[36,26,35,24],[36,27,35,25,"filter"],[36,33,35,31],[36,34,35,32,"task"],[36,38,35,36],[36,42,35,40,"tasksToCancel"],[36,55,35,53],[36,56,35,54,"indexOf"],[36,63,35,61],[36,64,35,62,"task"],[36,68,35,66],[36,69,35,67],[36,74,35,72],[36,75,35,73],[36,76,35,74],[37,6,36,4],[37,7,36,5],[37,8,36,6],[37,9,36,7],[37,10,36,8,"filter"],[37,16,36,14],[37,17,36,15],[37,18,36,16,"queue"],[37,23,36,21],[37,25,36,23,"idx"],[37,28,36,26],[37,33,36,31,"queue"],[37,38,36,36],[37,39,36,37,"tasks"],[37,44,36,42],[37,45,36,43,"length"],[37,51,36,49],[37,54,36,52],[37,55,36,53],[37,59,36,57,"idx"],[37,62,36,60],[37,67,36,65],[37,68,36,66],[37,69,36,67],[38,4,37,2],[39,4,38,2,"hasTasksToProcess"],[39,21,38,19,"hasTasksToProcess"],[39,22,38,19],[39,24,38,22],[40,6,39,4],[40,13,39,11],[40,17,39,15],[40,18,39,16,"_getCurrentQueue"],[40,34,39,32],[40,35,39,33],[40,36,39,34],[40,37,39,35,"length"],[40,43,39,41],[40,46,39,44],[40,47,39,45],[41,4,40,2],[43,4,42,2],[44,0,43,0],[45,0,44,0],[46,4,45,2,"processNext"],[46,15,45,13,"processNext"],[46,16,45,13],[46,18,45,16],[47,6,46,4],[47,10,46,8,"queue"],[47,15,46,13],[47,18,46,16],[47,22,46,20],[47,23,46,21,"_getCurrentQueue"],[47,39,46,37],[47,40,46,38],[47,41,46,39],[48,6,47,4],[48,10,47,8,"queue"],[48,15,47,13],[48,16,47,14,"length"],[48,22,47,20],[48,24,47,22],[49,8,48,6],[49,12,48,10,"task"],[49,16,48,14],[49,19,48,17,"queue"],[49,24,48,22],[49,25,48,23,"shift"],[49,30,48,28],[49,31,48,29],[49,32,48,30],[50,8,49,6],[50,12,49,10],[51,10,50,8],[51,14,50,12],[51,21,50,19,"task"],[51,25,50,23],[51,30,50,28],[51,38,50,36],[51,42,50,40,"task"],[51,46,50,44],[51,47,50,45,"gen"],[51,50,50,48],[51,52,50,50],[52,12,51,10],[52,16,51,14],[52,17,51,15,"_genPromise"],[52,28,51,26],[52,29,51,27,"task"],[52,33,51,31],[52,34,51,32],[53,10,52,8],[53,11,52,9],[53,17,52,15],[53,21,52,19],[53,28,52,26,"task"],[53,32,52,30],[53,37,52,35],[53,45,52,43],[53,49,52,47,"task"],[53,53,52,51],[53,54,52,52,"run"],[53,57,52,55],[53,59,52,57],[54,12,53,10,"task"],[54,16,53,14],[54,17,53,15,"run"],[54,20,53,18],[54,21,53,19],[54,22,53,20],[55,10,54,8],[55,11,54,9],[55,17,54,15],[56,12,55,10],[56,13,55,11],[56,14,55,12],[56,16,55,14,"_invariant"],[56,26,55,24],[56,27,55,25,"default"],[56,34,55,32],[56,36,55,34],[56,43,55,41,"task"],[56,47,55,45],[56,52,55,50],[56,62,55,60],[56,64,55,62],[56,123,55,121],[56,126,55,124,"JSON"],[56,130,55,128],[56,131,55,129,"stringify"],[56,140,55,138],[56,141,55,139,"task"],[56,145,55,143],[56,147,55,145],[56,151,55,149],[56,153,55,151],[56,154,55,152],[56,155,55,153],[56,156,55,154],[57,12,56,10,"task"],[57,16,56,14],[57,17,56,15],[57,18,56,16],[58,10,57,8],[59,8,58,6],[59,9,58,7],[59,10,58,8],[59,17,58,15,"e"],[59,18,58,16],[59,20,58,18],[60,10,59,8,"e"],[60,11,59,9],[60,12,59,10,"message"],[60,19,59,17],[60,22,59,20],[60,51,59,49],[60,55,59,53,"task"],[60,59,59,57],[60,60,59,58,"name"],[60,64,59,62],[60,68,59,66],[60,70,59,68],[60,71,59,69],[60,74,59,72],[60,78,59,76],[60,81,59,79,"e"],[60,82,59,80],[60,83,59,81,"message"],[60,90,59,88],[61,10,60,8],[61,16,60,14,"e"],[61,17,60,15],[62,8,61,6],[63,6,62,4],[64,4,63,2],[65,4,64,2,"_getCurrentQueue"],[65,20,64,18,"_getCurrentQueue"],[65,21,64,18],[65,23,64,21],[66,6,65,4],[66,10,65,8,"stackIdx"],[66,18,65,16],[66,21,65,19],[66,25,65,23],[66,26,65,24,"_queueStack"],[66,37,65,35],[66,38,65,36,"length"],[66,44,65,42],[66,47,65,45],[66,48,65,46],[67,6,66,4],[67,10,66,8,"queue"],[67,15,66,13],[67,18,66,16],[67,22,66,20],[67,23,66,21,"_queueStack"],[67,34,66,32],[67,35,66,33,"stackIdx"],[67,43,66,41],[67,44,66,42],[68,6,67,4],[68,10,67,8,"queue"],[68,15,67,13],[68,16,67,14,"popable"],[68,23,67,21],[68,27,67,25,"queue"],[68,32,67,30],[68,33,67,31,"tasks"],[68,38,67,36],[68,39,67,37,"length"],[68,45,67,43],[68,50,67,48],[68,51,67,49],[68,55,67,53,"stackIdx"],[68,63,67,61],[68,66,67,64],[68,67,67,65],[68,69,67,67],[69,8,68,6],[69,12,68,10],[69,13,68,11,"_queueStack"],[69,24,68,22],[69,25,68,23,"pop"],[69,28,68,26],[69,29,68,27],[69,30,68,28],[70,8,69,6],[70,15,69,13],[70,19,69,17],[70,20,69,18,"_getCurrentQueue"],[70,36,69,34],[70,37,69,35],[70,38,69,36],[71,6,70,4],[71,7,70,5],[71,13,70,11],[72,8,71,6],[72,15,71,13,"queue"],[72,20,71,18],[72,21,71,19,"tasks"],[72,26,71,24],[73,6,72,4],[74,4,73,2],[75,4,74,2,"_genPromise"],[75,15,74,13,"_genPromise"],[75,16,74,14,"task"],[75,20,74,18],[75,22,74,20],[76,6,75,4],[76,10,75,8,"length"],[76,16,75,14],[76,19,75,17],[76,23,75,21],[76,24,75,22,"_queueStack"],[76,35,75,33],[76,36,75,34,"push"],[76,40,75,38],[76,41,75,39],[77,8,76,6,"tasks"],[77,13,76,11],[77,15,76,13],[77,17,76,15],[78,8,77,6,"popable"],[78,15,77,13],[78,17,77,15],[79,6,78,4],[79,7,78,5],[79,8,78,6],[80,6,79,4],[80,10,79,8,"stackIdx"],[80,18,79,16],[80,21,79,19,"length"],[80,27,79,25],[80,30,79,28],[80,31,79,29],[81,6,80,4],[81,10,80,8,"stackItem"],[81,19,80,17],[81,22,80,20],[81,26,80,24],[81,27,80,25,"_queueStack"],[81,38,80,36],[81,39,80,37,"stackIdx"],[81,47,80,45],[81,48,80,46],[82,6,81,4,"task"],[82,10,81,8],[82,11,81,9,"gen"],[82,14,81,12],[82,15,81,13],[82,16,81,14],[82,17,81,15,"then"],[82,21,81,19],[82,22,81,20],[82,28,81,26],[83,8,82,6,"stackItem"],[83,17,82,15],[83,18,82,16,"popable"],[83,25,82,23],[83,28,82,26],[83,32,82,30],[84,8,83,6],[84,12,83,10],[84,13,83,11,"hasTasksToProcess"],[84,30,83,28],[84,31,83,29],[84,32,83,30],[84,36,83,34],[84,40,83,38],[84,41,83,39,"_onMoreTasks"],[84,53,83,51],[84,54,83,52],[84,55,83,53],[85,6,84,4],[85,7,84,5],[85,8,84,6],[85,9,84,7,"catch"],[85,14,84,12],[85,15,84,13,"ex"],[85,17,84,15],[85,21,84,19],[86,8,85,6,"setTimeout"],[86,18,85,16],[86,19,85,17],[86,25,85,23],[87,10,86,8,"ex"],[87,12,86,10],[87,13,86,11,"message"],[87,20,86,18],[87,23,86,21],[87,68,86,66],[87,71,86,69,"task"],[87,75,86,73],[87,76,86,74,"name"],[87,80,86,78],[87,83,86,81],[87,87,86,85],[87,90,86,88,"ex"],[87,92,86,90],[87,93,86,91,"message"],[87,100,86,98],[88,10,87,8],[88,16,87,14,"ex"],[88,18,87,16],[89,8,88,6],[89,9,88,7],[89,11,88,9],[89,12,88,10],[89,13,88,11],[90,6,89,4],[90,7,89,5],[90,8,89,6],[91,4,90,2],[92,2,91,0],[93,2,92,0],[93,6,92,4,"_default"],[93,14,92,12],[93,17,92,15,"exports"],[93,24,92,22],[93,25,92,23,"default"],[93,32,92,30],[93,35,92,33,"TaskQueue"],[93,44,92,42],[94,2,93,0,"module"],[94,8,93,6],[94,9,93,7,"exports"],[94,16,93,14],[94,19,93,17,"exports"],[94,26,93,24],[94,27,93,25,"default"],[94,34,93,32],[95,0,93,33],[95,3]],"functionMap":{"names":["<global>","TaskQueue","constructor","enqueue","enqueueTasks","tasks.forEach$argument_0","cancelTasks","_queueStack.map$argument_0","queue.tasks.filter$argument_0","_queueStack.map.filter$argument_0","hasTasksToProcess","processNext","_getCurrentQueue","_genPromise","task.gen.then$argument_0","task.gen.then._catch$argument_0","setTimeout$argument_0"],"mappings":"AAA;ACiB;ECC;GDO;EEC;GFE;EGC;kBCC,0BD;GHC;EKC;4CCC;gCCC,0CD;MDC,SG,mDH;GLC;ESC;GTE;EUK;GVkB;EWC;GXS;EYC;oBCO;KDG,QE;iBCC;ODG;KFC;GZC;CDC"},"hasCjsExports":true},"type":"js/module"}]}
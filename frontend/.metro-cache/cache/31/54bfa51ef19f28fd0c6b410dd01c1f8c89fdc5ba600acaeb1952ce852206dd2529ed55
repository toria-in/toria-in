{"dependencies":[{"name":"./subscribable.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":23},"end":{"line":2,"column":49,"index":72}}],"key":"f0fxTGZggQRtb//cHMvH9AHIWOw=","exportNames":["*"],"imports":1}},{"name":"./utils.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":73},"end":{"line":3,"column":38,"index":111}}],"key":"NIaSEHO1E48gsZc7jH9Ex1xTHgE=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"FocusManager\", {\n    enumerable: true,\n    get: function () {\n      return FocusManager;\n    }\n  });\n  Object.defineProperty(exports, \"focusManager\", {\n    enumerable: true,\n    get: function () {\n      return focusManager;\n    }\n  });\n  var _subscribableJs = require(_dependencyMap[0], \"./subscribable.js\");\n  var _utilsJs = require(_dependencyMap[1], \"./utils.js\");\n  // src/focusManager.ts\n\n  var FocusManager = class extends _subscribableJs.Subscribable {\n    #focused;\n    #cleanup;\n    #setup;\n    constructor() {\n      super();\n      this.#setup = onFocus => {\n        if (!_utilsJs.isServer && window.addEventListener) {\n          const listener = () => onFocus();\n          window.addEventListener(\"visibilitychange\", listener, false);\n          return () => {\n            window.removeEventListener(\"visibilitychange\", listener);\n          };\n        }\n        return;\n      };\n    }\n    onSubscribe() {\n      if (!this.#cleanup) {\n        this.setEventListener(this.#setup);\n      }\n    }\n    onUnsubscribe() {\n      if (!this.hasListeners()) {\n        this.#cleanup?.();\n        this.#cleanup = void 0;\n      }\n    }\n    setEventListener(setup) {\n      this.#setup = setup;\n      this.#cleanup?.();\n      this.#cleanup = setup(focused => {\n        if (typeof focused === \"boolean\") {\n          this.setFocused(focused);\n        } else {\n          this.onFocus();\n        }\n      });\n    }\n    setFocused(focused) {\n      const changed = this.#focused !== focused;\n      if (changed) {\n        this.#focused = focused;\n        this.onFocus();\n      }\n    }\n    onFocus() {\n      const isFocused = this.isFocused();\n      this.listeners.forEach(listener => {\n        listener(isFocused);\n      });\n    }\n    isFocused() {\n      if (typeof this.#focused === \"boolean\") {\n        return this.#focused;\n      }\n      return globalThis.document?.visibilityState !== \"hidden\";\n    }\n  };\n  var focusManager = new FocusManager();\n});","lineCount":83,"map":[[7,2,64,0,"Object"],[7,8,64,0],[7,9,64,0,"defineProperty"],[7,23,64,0],[7,24,64,0,"exports"],[7,31,64,0],[8,4,64,0,"enumerable"],[8,14,64,0],[9,4,64,0,"get"],[9,7,64,0],[9,18,64,0,"get"],[9,19,64,0],[10,6,64,0],[10,13,65,2,"FocusManager"],[10,25,65,14],[11,4,65,14],[12,2,65,14],[13,2,64,0,"Object"],[13,8,64,0],[13,9,64,0,"defineProperty"],[13,23,64,0],[13,24,64,0,"exports"],[13,31,64,0],[14,4,64,0,"enumerable"],[14,14,64,0],[15,4,64,0,"get"],[15,7,64,0],[15,18,64,0,"get"],[15,19,64,0],[16,6,64,0],[16,13,66,2,"focusManager"],[16,25,66,14],[17,4,66,14],[18,2,66,14],[19,2,2,0],[19,6,2,0,"_subscribableJs"],[19,21,2,0],[19,24,2,0,"require"],[19,31,2,0],[19,32,2,0,"_dependencyMap"],[19,46,2,0],[20,2,3,0],[20,6,3,0,"_utilsJs"],[20,14,3,0],[20,17,3,0,"require"],[20,24,3,0],[20,25,3,0,"_dependencyMap"],[20,39,3,0],[21,2,1,0],[23,2,4,0],[23,6,4,4,"FocusManager"],[23,18,4,16],[23,21,4,19],[23,35,4,33,"Subscribable"],[23,50,4,45],[23,51,4,45,"Subscribable"],[23,63,4,45],[23,64,4,46],[24,4,5,2],[24,5,5,3,"focused"],[24,12,5,10],[25,4,6,2],[25,5,6,3,"cleanup"],[25,12,6,10],[26,4,7,2],[26,5,7,3,"setup"],[26,10,7,8],[27,4,8,2,"constructor"],[27,15,8,13,"constructor"],[27,16,8,13],[27,18,8,16],[28,6,9,4],[28,11,9,9],[28,12,9,10],[28,13,9,11],[29,6,10,4],[29,10,10,8],[29,11,10,9],[29,12,10,10,"setup"],[29,17,10,15],[29,20,10,19,"onFocus"],[29,27,10,26],[29,31,10,31],[30,8,11,6],[30,12,11,10],[30,13,11,11,"isServer"],[30,21,11,19],[30,22,11,19,"isServer"],[30,30,11,19],[30,34,11,23,"window"],[30,40,11,29],[30,41,11,30,"addEventListener"],[30,57,11,46],[30,59,11,48],[31,10,12,8],[31,16,12,14,"listener"],[31,24,12,22],[31,27,12,25,"listener"],[31,28,12,25],[31,33,12,31,"onFocus"],[31,40,12,38],[31,41,12,39],[31,42,12,40],[32,10,13,8,"window"],[32,16,13,14],[32,17,13,15,"addEventListener"],[32,33,13,31],[32,34,13,32],[32,52,13,50],[32,54,13,52,"listener"],[32,62,13,60],[32,64,13,62],[32,69,13,67],[32,70,13,68],[33,10,14,8],[33,17,14,15],[33,23,14,21],[34,12,15,10,"window"],[34,18,15,16],[34,19,15,17,"removeEventListener"],[34,38,15,36],[34,39,15,37],[34,57,15,55],[34,59,15,57,"listener"],[34,67,15,65],[34,68,15,66],[35,10,16,8],[35,11,16,9],[36,8,17,6],[37,8,18,6],[38,6,19,4],[38,7,19,5],[39,4,20,2],[40,4,21,2,"onSubscribe"],[40,15,21,13,"onSubscribe"],[40,16,21,13],[40,18,21,16],[41,6,22,4],[41,10,22,8],[41,11,22,9],[41,15,22,13],[41,16,22,14],[41,17,22,15,"cleanup"],[41,24,22,22],[41,26,22,24],[42,8,23,6],[42,12,23,10],[42,13,23,11,"setEventListener"],[42,29,23,27],[42,30,23,28],[42,34,23,32],[42,35,23,33],[42,36,23,34,"setup"],[42,41,23,39],[42,42,23,40],[43,6,24,4],[44,4,25,2],[45,4,26,2,"onUnsubscribe"],[45,17,26,15,"onUnsubscribe"],[45,18,26,15],[45,20,26,18],[46,6,27,4],[46,10,27,8],[46,11,27,9],[46,15,27,13],[46,16,27,14,"hasListeners"],[46,28,27,26],[46,29,27,27],[46,30,27,28],[46,32,27,30],[47,8,28,6],[47,12,28,10],[47,13,28,11],[47,14,28,12,"cleanup"],[47,21,28,19],[47,24,28,22],[47,25,28,23],[48,8,29,6],[48,12,29,10],[48,13,29,11],[48,14,29,12,"cleanup"],[48,21,29,19],[48,24,29,22],[48,29,29,27],[48,30,29,28],[49,6,30,4],[50,4,31,2],[51,4,32,2,"setEventListener"],[51,20,32,18,"setEventListener"],[51,21,32,19,"setup"],[51,26,32,24],[51,28,32,26],[52,6,33,4],[52,10,33,8],[52,11,33,9],[52,12,33,10,"setup"],[52,17,33,15],[52,20,33,18,"setup"],[52,25,33,23],[53,6,34,4],[53,10,34,8],[53,11,34,9],[53,12,34,10,"cleanup"],[53,19,34,17],[53,22,34,20],[53,23,34,21],[54,6,35,4],[54,10,35,8],[54,11,35,9],[54,12,35,10,"cleanup"],[54,19,35,17],[54,22,35,20,"setup"],[54,27,35,25],[54,28,35,27,"focused"],[54,35,35,34],[54,39,35,39],[55,8,36,6],[55,12,36,10],[55,19,36,17,"focused"],[55,26,36,24],[55,31,36,29],[55,40,36,38],[55,42,36,40],[56,10,37,8],[56,14,37,12],[56,15,37,13,"setFocused"],[56,25,37,23],[56,26,37,24,"focused"],[56,33,37,31],[56,34,37,32],[57,8,38,6],[57,9,38,7],[57,15,38,13],[58,10,39,8],[58,14,39,12],[58,15,39,13,"onFocus"],[58,22,39,20],[58,23,39,21],[58,24,39,22],[59,8,40,6],[60,6,41,4],[60,7,41,5],[60,8,41,6],[61,4,42,2],[62,4,43,2,"setFocused"],[62,14,43,12,"setFocused"],[62,15,43,13,"focused"],[62,22,43,20],[62,24,43,22],[63,6,44,4],[63,12,44,10,"changed"],[63,19,44,17],[63,22,44,20],[63,26,44,24],[63,27,44,25],[63,28,44,26,"focused"],[63,35,44,33],[63,40,44,38,"focused"],[63,47,44,45],[64,6,45,4],[64,10,45,8,"changed"],[64,17,45,15],[64,19,45,17],[65,8,46,6],[65,12,46,10],[65,13,46,11],[65,14,46,12,"focused"],[65,21,46,19],[65,24,46,22,"focused"],[65,31,46,29],[66,8,47,6],[66,12,47,10],[66,13,47,11,"onFocus"],[66,20,47,18],[66,21,47,19],[66,22,47,20],[67,6,48,4],[68,4,49,2],[69,4,50,2,"onFocus"],[69,11,50,9,"onFocus"],[69,12,50,9],[69,14,50,12],[70,6,51,4],[70,12,51,10,"isFocused"],[70,21,51,19],[70,24,51,22],[70,28,51,26],[70,29,51,27,"isFocused"],[70,38,51,36],[70,39,51,37],[70,40,51,38],[71,6,52,4],[71,10,52,8],[71,11,52,9,"listeners"],[71,20,52,18],[71,21,52,19,"forEach"],[71,28,52,26],[71,29,52,28,"listener"],[71,37,52,36],[71,41,52,41],[72,8,53,6,"listener"],[72,16,53,14],[72,17,53,15,"isFocused"],[72,26,53,24],[72,27,53,25],[73,6,54,4],[73,7,54,5],[73,8,54,6],[74,4,55,2],[75,4,56,2,"isFocused"],[75,13,56,11,"isFocused"],[75,14,56,11],[75,16,56,14],[76,6,57,4],[76,10,57,8],[76,17,57,15],[76,21,57,19],[76,22,57,20],[76,23,57,21,"focused"],[76,30,57,28],[76,35,57,33],[76,44,57,42],[76,46,57,44],[77,8,58,6],[77,15,58,13],[77,19,58,17],[77,20,58,18],[77,21,58,19,"focused"],[77,28,58,26],[78,6,59,4],[79,6,60,4],[79,13,60,11,"globalThis"],[79,23,60,21],[79,24,60,22,"document"],[79,32,60,30],[79,34,60,32,"visibilityState"],[79,49,60,47],[79,54,60,52],[79,62,60,60],[80,4,61,2],[81,2,62,0],[81,3,62,1],[82,2,63,0],[82,6,63,4,"focusManager"],[82,18,63,16],[82,21,63,19],[82,25,63,23,"FocusManager"],[82,37,63,35],[82,38,63,36],[82,39,63,37],[83,0,63,38],[83,3]],"functionMap":{"names":["<global>","FocusManager","FocusManager#constructor","<anonymous>","listener","FocusManager#onSubscribe","FocusManager#onUnsubscribe","FocusManager#setEventListener","setup$argument_0","FocusManager#setFocused","FocusManager#onFocus","listeners.forEach$argument_0","FocusManager#isFocused"],"mappings":"AAA;mBCG;ECI;kBCE;yBCE,eD;KDO;GDC;EIC;GJI;EKC;GLK;EMC;0BCG;KDM;GNC;EQC;GRM;ESC;2BCE;KDE;GTC;EWC;GXK;CDC"},"hasCjsExports":false},"type":"js/module"}]}
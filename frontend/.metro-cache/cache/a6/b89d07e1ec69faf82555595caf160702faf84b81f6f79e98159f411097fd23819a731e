{"dependencies":[{"name":"./utils.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":21},"end":{"line":2,"column":63,"index":84}}],"key":"NIaSEHO1E48gsZc7jH9Ex1xTHgE=","exportNames":["*"],"imports":1}},{"name":"./query.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":85},"end":{"line":3,"column":35,"index":120}}],"key":"wqUrYlRol92tW0ObRFMnxaalj2Y=","exportNames":["*"],"imports":1}},{"name":"./notifyManager.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":121},"end":{"line":4,"column":51,"index":172}}],"key":"sE8Jk2BSATSKXEwal1fu77sfV3E=","exportNames":["*"],"imports":1}},{"name":"./subscribable.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":173},"end":{"line":5,"column":49,"index":222}}],"key":"f0fxTGZggQRtb//cHMvH9AHIWOw=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"QueryCache\", {\n    enumerable: true,\n    get: function () {\n      return QueryCache;\n    }\n  });\n  var _utilsJs = require(_dependencyMap[0], \"./utils.js\");\n  var _queryJs = require(_dependencyMap[1], \"./query.js\");\n  var _notifyManagerJs = require(_dependencyMap[2], \"./notifyManager.js\");\n  var _subscribableJs = require(_dependencyMap[3], \"./subscribable.js\");\n  // src/queryCache.ts\n\n  var QueryCache = class extends _subscribableJs.Subscribable {\n    constructor(config = {}) {\n      super();\n      this.config = config;\n      this.#queries = /* @__PURE__ */new Map();\n    }\n    #queries;\n    build(client, options, state) {\n      const queryKey = options.queryKey;\n      const queryHash = options.queryHash ?? (0, _utilsJs.hashQueryKeyByOptions)(queryKey, options);\n      let query = this.get(queryHash);\n      if (!query) {\n        query = new _queryJs.Query({\n          client,\n          queryKey,\n          queryHash,\n          options: client.defaultQueryOptions(options),\n          state,\n          defaultOptions: client.getQueryDefaults(queryKey)\n        });\n        this.add(query);\n      }\n      return query;\n    }\n    add(query) {\n      if (!this.#queries.has(query.queryHash)) {\n        this.#queries.set(query.queryHash, query);\n        this.notify({\n          type: \"added\",\n          query\n        });\n      }\n    }\n    remove(query) {\n      const queryInMap = this.#queries.get(query.queryHash);\n      if (queryInMap) {\n        query.destroy();\n        if (queryInMap === query) {\n          this.#queries.delete(query.queryHash);\n        }\n        this.notify({\n          type: \"removed\",\n          query\n        });\n      }\n    }\n    clear() {\n      _notifyManagerJs.notifyManager.batch(() => {\n        this.getAll().forEach(query => {\n          this.remove(query);\n        });\n      });\n    }\n    get(queryHash) {\n      return this.#queries.get(queryHash);\n    }\n    getAll() {\n      return [...this.#queries.values()];\n    }\n    find(filters) {\n      const defaultedFilters = {\n        exact: true,\n        ...filters\n      };\n      return this.getAll().find(query => (0, _utilsJs.matchQuery)(defaultedFilters, query));\n    }\n    findAll(filters = {}) {\n      const queries = this.getAll();\n      return Object.keys(filters).length > 0 ? queries.filter(query => (0, _utilsJs.matchQuery)(filters, query)) : queries;\n    }\n    notify(event) {\n      _notifyManagerJs.notifyManager.batch(() => {\n        this.listeners.forEach(listener => {\n          listener(event);\n        });\n      });\n    }\n    onFocus() {\n      _notifyManagerJs.notifyManager.batch(() => {\n        this.getAll().forEach(query => {\n          query.onFocus();\n        });\n      });\n    }\n    onOnline() {\n      _notifyManagerJs.notifyManager.batch(() => {\n        this.getAll().forEach(query => {\n          query.onOnline();\n        });\n      });\n    }\n  };\n});","lineCount":111,"map":[[7,2,94,0,"Object"],[7,8,94,0],[7,9,94,0,"defineProperty"],[7,23,94,0],[7,24,94,0,"exports"],[7,31,94,0],[8,4,94,0,"enumerable"],[8,14,94,0],[9,4,94,0,"get"],[9,7,94,0],[9,18,94,0,"get"],[9,19,94,0],[10,6,94,0],[10,13,95,2,"QueryCache"],[10,23,95,12],[11,4,95,12],[12,2,95,12],[13,2,2,0],[13,6,2,0,"_utilsJs"],[13,14,2,0],[13,17,2,0,"require"],[13,24,2,0],[13,25,2,0,"_dependencyMap"],[13,39,2,0],[14,2,3,0],[14,6,3,0,"_queryJs"],[14,14,3,0],[14,17,3,0,"require"],[14,24,3,0],[14,25,3,0,"_dependencyMap"],[14,39,3,0],[15,2,4,0],[15,6,4,0,"_notifyManagerJs"],[15,22,4,0],[15,25,4,0,"require"],[15,32,4,0],[15,33,4,0,"_dependencyMap"],[15,47,4,0],[16,2,5,0],[16,6,5,0,"_subscribableJs"],[16,21,5,0],[16,24,5,0,"require"],[16,31,5,0],[16,32,5,0,"_dependencyMap"],[16,46,5,0],[17,2,1,0],[19,2,6,0],[19,6,6,4,"QueryCache"],[19,16,6,14],[19,19,6,17],[19,33,6,31,"Subscribable"],[19,48,6,43],[19,49,6,43,"Subscribable"],[19,61,6,43],[19,62,6,44],[20,4,7,2,"constructor"],[20,15,7,13,"constructor"],[20,16,7,14,"config"],[20,22,7,20],[20,25,7,23],[20,26,7,24],[20,27,7,25],[20,29,7,27],[21,6,8,4],[21,11,8,9],[21,12,8,10],[21,13,8,11],[22,6,9,4],[22,10,9,8],[22,11,9,9,"config"],[22,17,9,15],[22,20,9,18,"config"],[22,26,9,24],[23,6,10,4],[23,10,10,8],[23,11,10,9],[23,12,10,10,"queries"],[23,19,10,17],[23,22,10,20],[23,37,10,36],[23,41,10,40,"Map"],[23,44,10,43],[23,45,10,44],[23,46,10,45],[24,4,11,2],[25,4,12,2],[25,5,12,3,"queries"],[25,12,12,10],[26,4,13,2,"build"],[26,9,13,7,"build"],[26,10,13,8,"client"],[26,16,13,14],[26,18,13,16,"options"],[26,25,13,23],[26,27,13,25,"state"],[26,32,13,30],[26,34,13,32],[27,6,14,4],[27,12,14,10,"queryKey"],[27,20,14,18],[27,23,14,21,"options"],[27,30,14,28],[27,31,14,29,"queryKey"],[27,39,14,37],[28,6,15,4],[28,12,15,10,"queryHash"],[28,21,15,19],[28,24,15,22,"options"],[28,31,15,29],[28,32,15,30,"queryHash"],[28,41,15,39],[28,45,15,43],[28,49,15,43,"hashQueryKeyByOptions"],[28,57,15,64],[28,58,15,64,"hashQueryKeyByOptions"],[28,79,15,64],[28,81,15,65,"queryKey"],[28,89,15,73],[28,91,15,75,"options"],[28,98,15,82],[28,99,15,83],[29,6,16,4],[29,10,16,8,"query"],[29,15,16,13],[29,18,16,16],[29,22,16,20],[29,23,16,21,"get"],[29,26,16,24],[29,27,16,25,"queryHash"],[29,36,16,34],[29,37,16,35],[30,6,17,4],[30,10,17,8],[30,11,17,9,"query"],[30,16,17,14],[30,18,17,16],[31,8,18,6,"query"],[31,13,18,11],[31,16,18,14],[31,20,18,18,"Query"],[31,28,18,23],[31,29,18,23,"Query"],[31,34,18,23],[31,35,18,24],[32,10,19,8,"client"],[32,16,19,14],[33,10,20,8,"queryKey"],[33,18,20,16],[34,10,21,8,"queryHash"],[34,19,21,17],[35,10,22,8,"options"],[35,17,22,15],[35,19,22,17,"client"],[35,25,22,23],[35,26,22,24,"defaultQueryOptions"],[35,45,22,43],[35,46,22,44,"options"],[35,53,22,51],[35,54,22,52],[36,10,23,8,"state"],[36,15,23,13],[37,10,24,8,"defaultOptions"],[37,24,24,22],[37,26,24,24,"client"],[37,32,24,30],[37,33,24,31,"getQueryDefaults"],[37,49,24,47],[37,50,24,48,"queryKey"],[37,58,24,56],[38,8,25,6],[38,9,25,7],[38,10,25,8],[39,8,26,6],[39,12,26,10],[39,13,26,11,"add"],[39,16,26,14],[39,17,26,15,"query"],[39,22,26,20],[39,23,26,21],[40,6,27,4],[41,6,28,4],[41,13,28,11,"query"],[41,18,28,16],[42,4,29,2],[43,4,30,2,"add"],[43,7,30,5,"add"],[43,8,30,6,"query"],[43,13,30,11],[43,15,30,13],[44,6,31,4],[44,10,31,8],[44,11,31,9],[44,15,31,13],[44,16,31,14],[44,17,31,15,"queries"],[44,24,31,22],[44,25,31,23,"has"],[44,28,31,26],[44,29,31,27,"query"],[44,34,31,32],[44,35,31,33,"queryHash"],[44,44,31,42],[44,45,31,43],[44,47,31,45],[45,8,32,6],[45,12,32,10],[45,13,32,11],[45,14,32,12,"queries"],[45,21,32,19],[45,22,32,20,"set"],[45,25,32,23],[45,26,32,24,"query"],[45,31,32,29],[45,32,32,30,"queryHash"],[45,41,32,39],[45,43,32,41,"query"],[45,48,32,46],[45,49,32,47],[46,8,33,6],[46,12,33,10],[46,13,33,11,"notify"],[46,19,33,17],[46,20,33,18],[47,10,34,8,"type"],[47,14,34,12],[47,16,34,14],[47,23,34,21],[48,10,35,8,"query"],[49,8,36,6],[49,9,36,7],[49,10,36,8],[50,6,37,4],[51,4,38,2],[52,4,39,2,"remove"],[52,10,39,8,"remove"],[52,11,39,9,"query"],[52,16,39,14],[52,18,39,16],[53,6,40,4],[53,12,40,10,"queryInMap"],[53,22,40,20],[53,25,40,23],[53,29,40,27],[53,30,40,28],[53,31,40,29,"queries"],[53,38,40,36],[53,39,40,37,"get"],[53,42,40,40],[53,43,40,41,"query"],[53,48,40,46],[53,49,40,47,"queryHash"],[53,58,40,56],[53,59,40,57],[54,6,41,4],[54,10,41,8,"queryInMap"],[54,20,41,18],[54,22,41,20],[55,8,42,6,"query"],[55,13,42,11],[55,14,42,12,"destroy"],[55,21,42,19],[55,22,42,20],[55,23,42,21],[56,8,43,6],[56,12,43,10,"queryInMap"],[56,22,43,20],[56,27,43,25,"query"],[56,32,43,30],[56,34,43,32],[57,10,44,8],[57,14,44,12],[57,15,44,13],[57,16,44,14,"queries"],[57,23,44,21],[57,24,44,22,"delete"],[57,30,44,28],[57,31,44,29,"query"],[57,36,44,34],[57,37,44,35,"queryHash"],[57,46,44,44],[57,47,44,45],[58,8,45,6],[59,8,46,6],[59,12,46,10],[59,13,46,11,"notify"],[59,19,46,17],[59,20,46,18],[60,10,46,20,"type"],[60,14,46,24],[60,16,46,26],[60,25,46,35],[61,10,46,37,"query"],[62,8,46,43],[62,9,46,44],[62,10,46,45],[63,6,47,4],[64,4,48,2],[65,4,49,2,"clear"],[65,9,49,7,"clear"],[65,10,49,7],[65,12,49,10],[66,6,50,4,"notifyManager"],[66,22,50,17],[66,23,50,17,"notifyManager"],[66,36,50,17],[66,37,50,18,"batch"],[66,42,50,23],[66,43,50,24],[66,49,50,30],[67,8,51,6],[67,12,51,10],[67,13,51,11,"getAll"],[67,19,51,17],[67,20,51,18],[67,21,51,19],[67,22,51,20,"forEach"],[67,29,51,27],[67,30,51,29,"query"],[67,35,51,34],[67,39,51,39],[68,10,52,8],[68,14,52,12],[68,15,52,13,"remove"],[68,21,52,19],[68,22,52,20,"query"],[68,27,52,25],[68,28,52,26],[69,8,53,6],[69,9,53,7],[69,10,53,8],[70,6,54,4],[70,7,54,5],[70,8,54,6],[71,4,55,2],[72,4,56,2,"get"],[72,7,56,5,"get"],[72,8,56,6,"queryHash"],[72,17,56,15],[72,19,56,17],[73,6,57,4],[73,13,57,11],[73,17,57,15],[73,18,57,16],[73,19,57,17,"queries"],[73,26,57,24],[73,27,57,25,"get"],[73,30,57,28],[73,31,57,29,"queryHash"],[73,40,57,38],[73,41,57,39],[74,4,58,2],[75,4,59,2,"getAll"],[75,10,59,8,"getAll"],[75,11,59,8],[75,13,59,11],[76,6,60,4],[76,13,60,11],[76,14,60,12],[76,17,60,15],[76,21,60,19],[76,22,60,20],[76,23,60,21,"queries"],[76,30,60,28],[76,31,60,29,"values"],[76,37,60,35],[76,38,60,36],[76,39,60,37],[76,40,60,38],[77,4,61,2],[78,4,62,2,"find"],[78,8,62,6,"find"],[78,9,62,7,"filters"],[78,16,62,14],[78,18,62,16],[79,6,63,4],[79,12,63,10,"defaultedFilters"],[79,28,63,26],[79,31,63,29],[80,8,63,31,"exact"],[80,13,63,36],[80,15,63,38],[80,19,63,42],[81,8,63,44],[81,11,63,47,"filters"],[82,6,63,55],[82,7,63,56],[83,6,64,4],[83,13,64,11],[83,17,64,15],[83,18,64,16,"getAll"],[83,24,64,22],[83,25,64,23],[83,26,64,24],[83,27,64,25,"find"],[83,31,64,29],[83,32,65,7,"query"],[83,37,65,12],[83,41,65,17],[83,45,65,17,"matchQuery"],[83,53,65,27],[83,54,65,27,"matchQuery"],[83,64,65,27],[83,66,65,28,"defaultedFilters"],[83,82,65,44],[83,84,65,46,"query"],[83,89,65,51],[83,90,66,4],[83,91,66,5],[84,4,67,2],[85,4,68,2,"findAll"],[85,11,68,9,"findAll"],[85,12,68,10,"filters"],[85,19,68,17],[85,22,68,20],[85,23,68,21],[85,24,68,22],[85,26,68,24],[86,6,69,4],[86,12,69,10,"queries"],[86,19,69,17],[86,22,69,20],[86,26,69,24],[86,27,69,25,"getAll"],[86,33,69,31],[86,34,69,32],[86,35,69,33],[87,6,70,4],[87,13,70,11,"Object"],[87,19,70,17],[87,20,70,18,"keys"],[87,24,70,22],[87,25,70,23,"filters"],[87,32,70,30],[87,33,70,31],[87,34,70,32,"length"],[87,40,70,38],[87,43,70,41],[87,44,70,42],[87,47,70,45,"queries"],[87,54,70,52],[87,55,70,53,"filter"],[87,61,70,59],[87,62,70,61,"query"],[87,67,70,66],[87,71,70,71],[87,75,70,71,"matchQuery"],[87,83,70,81],[87,84,70,81,"matchQuery"],[87,94,70,81],[87,96,70,82,"filters"],[87,103,70,89],[87,105,70,91,"query"],[87,110,70,96],[87,111,70,97],[87,112,70,98],[87,115,70,101,"queries"],[87,122,70,108],[88,4,71,2],[89,4,72,2,"notify"],[89,10,72,8,"notify"],[89,11,72,9,"event"],[89,16,72,14],[89,18,72,16],[90,6,73,4,"notifyManager"],[90,22,73,17],[90,23,73,17,"notifyManager"],[90,36,73,17],[90,37,73,18,"batch"],[90,42,73,23],[90,43,73,24],[90,49,73,30],[91,8,74,6],[91,12,74,10],[91,13,74,11,"listeners"],[91,22,74,20],[91,23,74,21,"forEach"],[91,30,74,28],[91,31,74,30,"listener"],[91,39,74,38],[91,43,74,43],[92,10,75,8,"listener"],[92,18,75,16],[92,19,75,17,"event"],[92,24,75,22],[92,25,75,23],[93,8,76,6],[93,9,76,7],[93,10,76,8],[94,6,77,4],[94,7,77,5],[94,8,77,6],[95,4,78,2],[96,4,79,2,"onFocus"],[96,11,79,9,"onFocus"],[96,12,79,9],[96,14,79,12],[97,6,80,4,"notifyManager"],[97,22,80,17],[97,23,80,17,"notifyManager"],[97,36,80,17],[97,37,80,18,"batch"],[97,42,80,23],[97,43,80,24],[97,49,80,30],[98,8,81,6],[98,12,81,10],[98,13,81,11,"getAll"],[98,19,81,17],[98,20,81,18],[98,21,81,19],[98,22,81,20,"forEach"],[98,29,81,27],[98,30,81,29,"query"],[98,35,81,34],[98,39,81,39],[99,10,82,8,"query"],[99,15,82,13],[99,16,82,14,"onFocus"],[99,23,82,21],[99,24,82,22],[99,25,82,23],[100,8,83,6],[100,9,83,7],[100,10,83,8],[101,6,84,4],[101,7,84,5],[101,8,84,6],[102,4,85,2],[103,4,86,2,"onOnline"],[103,12,86,10,"onOnline"],[103,13,86,10],[103,15,86,13],[104,6,87,4,"notifyManager"],[104,22,87,17],[104,23,87,17,"notifyManager"],[104,36,87,17],[104,37,87,18,"batch"],[104,42,87,23],[104,43,87,24],[104,49,87,30],[105,8,88,6],[105,12,88,10],[105,13,88,11,"getAll"],[105,19,88,17],[105,20,88,18],[105,21,88,19],[105,22,88,20,"forEach"],[105,29,88,27],[105,30,88,29,"query"],[105,35,88,34],[105,39,88,39],[106,10,89,8,"query"],[106,15,89,13],[106,16,89,14,"onOnline"],[106,24,89,22],[106,25,89,23],[106,26,89,24],[107,8,90,6],[107,9,90,7],[107,10,90,8],[108,6,91,4],[108,7,91,5],[108,8,91,6],[109,4,92,2],[110,2,93,0],[110,3,93,1],[111,0,93,2],[111,3]],"functionMap":{"names":["<global>","QueryCache","QueryCache#constructor","QueryCache#build","QueryCache#add","QueryCache#remove","QueryCache#clear","notifyManager.batch$argument_0","getAll.forEach$argument_0","QueryCache#get","QueryCache#getAll","QueryCache#find","getAll.find$argument_0","QueryCache#findAll","queries.filter$argument_0","QueryCache#notify","listeners.forEach$argument_0","QueryCache#onFocus","QueryCache#onOnline"],"mappings":"AAA;iBCK;ECC;GDI;EEE;GFgB;EGC;GHQ;EIC;GJS;EKC;wBCC;4BCC;ODE;KDC;GLC;EQC;GRE;ESC;GTE;EUC;MCG,8CD;GVE;EYC;4DCE,qCD;GZC;EcC;wBRC;6BSC;OTE;KQC;GdC;EgBC;wBVC;4BCC;ODE;KUC;GhBC;EiBC;wBXC;4BCC;ODE;KWC;GjBC;CDC"},"hasCjsExports":false},"type":"js/module"}]}